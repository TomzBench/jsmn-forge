openapi: 3.1.0
info:
  title: Constraint Violations
  version: "0"
paths:
  /api/v1/sensor:
    get:
      operationId: getSensor
      responses:
        "200":
          description: Sensor reading
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/sensor_reading"
    post:
      operationId: configureSensor
      requestBody:
        content:
          application/json:
            schema:
              type: object
              required: [label]
              properties:
                # unbounded string in inline schema
                label:
                  type: string
                # unbounded array in inline schema
                thresholds:
                  type: array
                  items:
                    type: integer
                    format: uint32
      responses:
        "200":
          description: Configured
components:
  schemas:
    # multiple violations in a single component
    sensor_reading:
      type: object
      required: [name, samples, tags, config]
      properties:
        # unbounded string — no maxLength
        name:
          type: string
        # unbounded array — no maxItems
        samples:
          type: array
          items:
            type: integer
            format: uint32
        # array of unbounded strings
        tags:
          type: array
          maxItems: 8
          items:
            type: string
        # nested object with its own violations
        config:
          type: object
          required: [mode, description]
          properties:
            # unbounded string nested one level deep
            mode:
              type: string
            # another unbounded string
            description:
              type: string
            # unbounded array nested one level deep
            schedule:
              type: array
              items:
                type: integer
                format: uint16
    # all violations are unbounded arrays
    event_log:
      type: object
      required: [events]
      properties:
        events:
          type: array
          items:
            type: object
            required: [ts, code, message]
            properties:
              ts:
                type: integer
                format: uint64
              code:
                type: integer
                format: uint16
              # unbounded string inside unbounded array items
              message:
                type: string
    # string format without maxLength
    endpoint:
      type: object
      required: [host, path, token]
      properties:
        host:
          type: string
          format: hostname
        path:
          type: string
          format: uri
        token:
          type: string
          format: password
