openapi: 3.1.0
info:
  title: Network Configuration
  version: "0"
paths:
  /api/v1/network:
    get:
      operationId: getNetwork
      responses:
        "200":
          description: Current network configuration
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/network_config"
    put:
      operationId: updateNetwork
      requestBody:
        required: true
        content:
          application/json:
            schema:
              x-jsmn-id: network_update
              type: object
              properties:
                ip:
                  type: string
                  maxLength: 15
                mask:
                  type: string
                  maxLength: 15
                gateway:
                  type: string
                  maxLength: 15
                dns:
                  type: array
                  maxItems: 2
                  items:
                    type: string
                    maxLength: 15
      responses:
        "200":
          description: Configuration applied
  /api/v1/network/scan:
    get:
      operationId: scanNetworks
      responses:
        "200":
          description: Visible networks
          content:
            application/json:
              schema:
                type: array
                maxItems: 16
                items:
                  type: object
                  required: [ssid, rssi, channel]
                  properties:
                    ssid:
                      type: string
                      maxLength: 32
                    rssi:
                      type: integer
                      format: int8
                    channel:
                      type: integer
                      format: uint8
                    secure:
                      type: boolean
  /api/v1/network/test:
    post:
      operationId: testConnection
      parameters:
        - name: timeout
          in: query
          schema:
            type: integer
            format: uint16
      requestBody:
        required: true
        content:
          application/json:
            schema:
              x-jsmn-id: connection_test
              type: object
              required: [host]
              properties:
                host:
                  type: string
                  maxLength: 64
                port:
                  type: integer
                  format: uint16
      responses:
        "200":
          description: Test result
          content:
            application/json:
              schema:
                type: object
                required: [reachable, latency]
                properties:
                  reachable:
                    type: boolean
                  latency:
                    type: integer
                    format: uint32
                  error:
                    type: string
                    maxLength: 128
components:
  schemas:
    network_config:
      type: object
      required: [ip, mask, gateway]
      properties:
        ip:
          type: string
          maxLength: 15
        mask:
          type: string
          maxLength: 15
        gateway:
          type: string
          maxLength: 15
        dns:
          type: array
          maxItems: 2
          items:
            type: string
            maxLength: 15
